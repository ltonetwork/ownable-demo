<!doctype html>

<html>
    <body>
        <script>
            async function test() {
                // instantiate the wasm binary to be imported
                let externalWasmModule = await WebAssembly.instantiateStreaming(
                    fetch('./target/wasm32-unknown-unknown/debug/wasm_import_lib.wasm'),
                    {}
                );

                var importObject = { imports: {
                        imported_func: arg => externalWasmModule.instance.exports.print_i32(arg),
                        add_five: arg => externalWasmModule.instance.exports.add_five(arg),
                    },
                };

                WebAssembly.instantiateStreaming(
                    fetch('./target/wasm32-unknown-unknown/debug/wasm_playground.wasm'),
                    importObject
                ).then(wasm_binary => {
                    console.log(wasm_binary);
                    // calls imported_func
                    wasm_binary.instance.exports.exported_func(5);
                    console.log(wasm_binary.instance.exports.imported_add_five(10));
                });
            }

            test()
        </script>
    </body>
</html>